<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chemistry Wiki - Search Enabled</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { display: flex; flex-direction: column; align-items: center; background-color: white; padding: 20px; font-family: sans-serif; }
        
        .banner { width: 550px; height: 160px; border: 4px solid black; display: flex; justify-content: center; align-items: center; font-size: 70px; margin-bottom: 30px; }

        .search-box { width: 550px; height: 40px; border: 3px solid black; display: flex; align-items: center; margin-bottom: 30px; }
        .search-box input { width: 100%; border: none; height: 100%; text-align: center; font-size: 20px; font-weight: bold; outline: none; }

        .molecule-section { width: 550px; margin-bottom: 40px; }
        .label { font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
        
        /* Empty Knowledge boxes as requested */
        .knowledge-box { width: 300px; height: 50px; border: 3px solid black; margin-bottom: 15px; }

        .viewer-3d { width: 450px; height: 220px; background-color: #808080; border: 3px solid black; cursor: move; }
        
        #search-results { width: 550px; border-top: 2px dashed black; padding-top: 20px; display: none; }
    </style>
</head>
<body>

    <div class="banner">Banner</div>

    <div class="search-box">
        <input type="text" id="main-search" placeholder="SEARCH BOX (Type & Press Enter)" onkeypress="handleSearch(event)">
    </div>

    <div class="molecule-section">
        <div class="label">HCL (Hydrochloric Acid)</div>
        <div class="knowledge-box"></div>
        <div id="hcl-container" class="viewer-3d"></div>
    </div>

    <div class="molecule-section">
        <div class="label">H20 (Water)</div>
        <div class="knowledge-box"></div>
        <div id="h2o-container" class="viewer-3d"></div>
    </div>

    <div class="molecule-section">
        <div class="label">Glucose (C6H12O6)</div>
        <div class="knowledge-box"></div>
        <div id="glucose-container" class="viewer-3d"></div>
    </div>

    <div id="search-results" class="molecule-section">
        <div class="label" id="search-label">Result</div>
        <div class="knowledge-box"></div>
        <div id="search-container" class="viewer-3d"></div>
    </div>

    <script>
        // Core function to build the 3D structure
        function buildMolecule(containerId, atoms, bonds) {
            const container = document.getElementById(containerId);
            container.innerHTML = ''; // Clear existing
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setClearColor(0x808080);
            container.appendChild(renderer.domElement);

            scene.add(new THREE.AmbientLight(0xffffff, 0.7));
            const light = new THREE.PointLight(0xffffff, 0.8);
            light.position.set(10, 10, 10);
            scene.add(light);

            atoms.forEach(a => {
                const sphere = new THREE.Mesh(
                    new THREE.SphereGeometry(a.size, 24, 24),
                    new THREE.MeshPhongMaterial({ color: a.color })
                );
                sphere.position.set(a.x, a.y, a.z);
                scene.add(sphere);
            });

            bonds.forEach(b => {
                const start = new THREE.Vector3(atoms[b.from].x, atoms[b.from].y, atoms[b.from].z);
                const end = new THREE.Vector3(atoms[b.to].x, atoms[b.to].y, atoms[b.to].z);
                const path = new THREE.LineCurve3(start, end);
                const tube = new THREE.Mesh(
                    new THREE.TubeGeometry(path, 1, 0.1, 8, false),
                    new THREE.MeshPhongMaterial({ color: 0xeeeeee })
                );
                scene.add(tube);
            });

            camera.position.z = 8;
            function animate() { requestAnimationFrame(animate); scene.rotation.y += 0.01; renderer.render(scene, camera); }
            animate();
        }

        // 1. Initial Molecules
        // HCl
        buildMolecule('hcl-container', 
            [{color: 0xff0000, size: 0.7, x: -1, y: 0, z: 0}, {color: 0x00ff00, size: 0.5, x: 1, y: 0, z: 0}], 
            [{from: 0, to: 1}]
        );

        // H2O
        buildMolecule('h2o-container', 
            [{color: 0x00ff00, size: 0.6, x: 0, y: 0.4, z: 0}, {color: 0x0000ff, size: 0.4, x: -0.8, y: -0.4, z: 0}, {color: 0x0000ff, size: 0.4, x: 0.8, y: -0.4, z: 0}], 
            [{from: 0, to: 1}, {from: 0, to: 2}]
        );

        // Glucose (simplified ring)
        const gAtoms = [
            {color: 0x444444, size: 0.5, x: 0, y: 1, z: 0}, {color: 0x444444, size: 0.5, x: 1, y: 0.5, z: 0.5},
            {color: 0x444444, size: 0.5, x: 1, y: -0.5, z: 0.5}, {color: 0x444444, size: 0.5, x: 0, y: -1, z: 0},
            {color: 0x444444, size: 0.5, x: -1, y: -0.5, z: -0.5}, {color: 0xff0000, size: 0.5, x: -1, y: 0.5, z: -0.5}
        ];
        const gBonds = [{from:0,to:1},{from:1,to:2},{from:2,to:3},{from:3,to:4},{from:4,to:5},{from:5,to:0}];
        buildMolecule('glucose-container', gAtoms, gBonds);

        // 2. Search Box Logic
        function handleSearch(event) {
            if (event.key === "Enter") {
                const query = document.getElementById('main-search').value;
                document.getElementById('search-results').style.display = 'block';
                document.getElementById('search-label').innerText = "Result: " + query;
                
                // For the search, we draw a random "Search Result" molecule structure
                buildMolecule('search-container', 
                    [{color: Math.random() * 0xffffff, size: 0.6, x: 0, y: 0, z: 0}, {color: 0xcccccc, size: 0.4, x: 1.5, y: 1, z: 0}], 
                    [{from: 0, to: 1}]
                );
            }
        }
    </script>
</body>
</html>
